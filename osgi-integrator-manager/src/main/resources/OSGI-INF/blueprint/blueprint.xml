<?xml version="1.0" encoding="UTF-8"?>

<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0" 
		   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		   xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0"
           xsi:schemaLocation="
  http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
  http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0 http://aries.apache.org/schemas/blueprint-cm/blueprint-cm-1.1.0.xsd
  ">

  <!-- Default Plugin Properties -->
  <cm:property-placeholder persistent-id="com.pentaho.krios.plugins.osgi.integrator.manager" update-strategy="reload">
    <cm:default-properties>
      <cm:property name="active" value="true"/>
    </cm:default-properties>
  </cm:property-placeholder>

  <!-- Integrator Manager Service Implementation -->
  <bean id="integratorManager" class="com.pentaho.krios.plugins.osgi.integrator.manager.IntegratorManagerServicesImpl">
    <property name="active" value="${active}" />
    <property name="configAdmin" ref="configAdmin" />
  	<property name="tokenProviders" ref="tokenProviders" />
  </bean>
	
  <!-- To access the plugin props inside the bean -->
  <reference id="configAdmin" interface="org.osgi.service.cm.ConfigurationAdmin" />	

  <!-- Register the Integrator Manager Service -->  
  <service id="integratorManagerService" ref="integratorManager"
    interface="com.pentaho.krios.plugins.osgi.integrator.common.services.IntegratorManagerService" />
    
  <!-- List of Token Providers -->
  <reference-list id="tokenProviders" availability="optional"
	interface="com.pentaho.krios.plugins.osgi.integrator.common.services.ITokenService" />	

</blueprint>